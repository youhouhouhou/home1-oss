<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2017-04-29 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170429" />
    <meta http-equiv="Content-Language" content="en" />
    <title>oss-eureka &#x2013; Eureka Graceful Shutdown</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">DOCUMENTATION <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="README.html"  title="README">README</a>
</li>
                  
                      <li>      <a href="CONTRIBUTION.html"  title="开发">开发</a>
</li>
                  
                      <li>      <a href="GRACEFUL_SHUTDOWN.html"  title="优雅关闭服务">优雅关闭服务</a>
</li>
                  
                      <li>      <a href="SELF_PRESERVATION.html"  title="自我保护模式">自我保护模式</a>
</li>
                  
                      <li>      <a href="PERFORMANCE.html"  title="压力测试">压力测试</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="integration.html"  title="CI Management">CI Management</a>
</li>
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="index.html"  title="About">About</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Summary">Summary</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Management">Issue Management</a>
</li>
                                  <li>      <a href="team-list.html"  title="Team">Team</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Code Management">Source Code Management</a>
</li>
                                  <li>      <a href="license.html"  title="Licenses">Licenses</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="jacoco/index.html"  title="JaCoCo">JaCoCo</a>
</li>
                                  <li>      <a href="clirr-report.html"  title="Clirr">Clirr</a>
</li>
                                  <li>      <a href="surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs">FindBugs</a>
</li>
                                  <li>      <a href="jdepend-report.html"  title="JDepend">JDepend</a>
</li>
                                  <li>      <a href="checkstyle.html"  title="Checkstyle">Checkstyle</a>
</li>
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="taglist.html"  title="Tag List">Tag List</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>oss-eureka</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2017-04-29
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.0.6.OSS
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">DOCUMENTATION</li>
                              
      <li>
  
                          <a href="README.html" title="README">
          <span class="none"></span>
        README</a>
            </li>
                
      <li>
  
                          <a href="CONTRIBUTION.html" title="开发">
          <span class="none"></span>
        开发</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>优雅关闭服务</a>
          </li>
                
      <li>
  
                          <a href="SELF_PRESERVATION.html" title="自我保护模式">
          <span class="none"></span>
        自我保护模式</a>
            </li>
                
      <li>
  
                          <a href="PERFORMANCE.html" title="压力测试">
          <span class="none"></span>
        压力测试</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                              
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                    
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1><a href="#eureka-graceful-shutdown">Eureka Graceful Shutdown</a></h1>

<div class="section">
<h2><a name="a"></a><a href="#a-">&#x4ec0;&#x4e48;&#x662f;&#x4f18;&#x96c5;&#x5173;&#x95ed;&#xff1f;</a></h2>

<p>&#x4f18;&#x96c5;&#x5173;&#x95ed;&#x662f;&#x6307;&#x5728;&#x5173;&#x95ed;&#x524d;&#x505a;&#x5fc5;&#x8981;&#x7684;&#x64cd;&#x4f5c;&#x540e;&#x518d;&#x5173;&#x95ed;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff0c;&#x4e0d;&#x540c;&#x4e8e;&#x7b80;&#x5355;&#x7c97;&#x66b4;&#x76f4;&#x63a5;&#x5173;&#x95ed;&#x7a0b;&#x5e8f;&#x7684;&#x65b9;&#x6cd5;&#xff0c;&#x8ddf;&#x540e;&#x8005;&#x6bd4;&#x66f4;&#x52a0;&#x6587;&#x660e;&#x3001;&#x4f18;&#x96c5;&#xff0c;&#x56e0;&#x800c;&#x5f97;&#x540d;&#x3002;</p>
</div>
<div class="section">
<h2><a name="a"></a><a href="#a">&#x4f18;&#x96c5;&#x5173;&#x95ed;&#x672c;&#x5730;&#x670d;&#x52a1;</a></h2>

<p>&#x547d;&#x4ee4;&#x884c;&#x6a21;&#x5f0f;&#xff1a;<tt>kill pid</tt> &#x53d1;&#x9001;&#x9ed8;&#x8ba4;&#x4fe1;&#x53f7;&#xff1a;15 SIGTERM<br /> Idea&#xff1a;<img src="images/idea_graceful_shutdown.png" alt="idea graceful shutdown" /><br /> eclipse: &#x6682;&#x4e0d;&#x652f;&#x6301;<br /> docker&#xff1a;docker stop &#x6216; docker-compose stop</p>
</div>
<div class="section">
<h2><a name="spring-bootEureka_InstanceGraceful_Shutdown"></a>spring-boot&#x73af;&#x5883;&#x4e0b;Eureka Instance(&#x5e94;&#x7528;/&#x670d;&#x52a1;&#x5b9e;&#x4f8b;)&#x7684;Graceful Shutdown</h2>

<div class="section">
<h3><a name="a"></a><a href="#a">&#x5206;&#x6790;</a></h3>

<p>&#x4e0b;&#x9762;&#x4ee5;Eureka Instance&#x6536;&#x5230;&#x5173;&#x95ed;&#x6307;&#x4ee4;&#x540e;&#x7684;&#x5904;&#x7406;&#x6d41;&#x7a0b;&#x4e3a;&#x4f8b;&#x8bf4;&#x660e;Eureka&#x7684;&#x5173;&#x95ed;&#x6d41;&#x7a0b;</p>

<ul>
  
<li>Eureka Instance&#x6536;&#x5230;&#x5173;&#x95ed;&#x6307;&#x4ee4;&#x540e;&#x4f1a;&#x81ea;&#x52a8;&#x89e6;&#x53d1;&#x901a;&#x77e5;Eureka Server&#x7684;&#x64cd;&#x4f5c;</li>
</ul>

<p>&#x65e5;&#x5fd7;&#x4e2d;&#x80fd;&#x770b;&#x5230;&#x5982;&#x4e0b;&#x5b57;&#x6bb5;</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Shutting down DiscoveryClient ...
</pre></div></div>

<p>&#x67e5;&#x770b;com.netflix.discovery.DiscoveryClient&#x4ee3;&#x7801;&#xff1a;</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">public class DiscoveryClient implements EurekaClient {

  @PreDestroy
  @Override
  public synchronized void shutdown() {
    ...
  }  
}
</pre></div></div>

<p>&#x4f1a;&#x53d1;&#x73b0;&#x6709;&#x5173;&#x95ed;&#x5904;&#x7406;&#x6ce8;&#x89e3;@PreDestroy</p>

<ul>
  
<li>
  
<p>Eureka Server&#x6536;&#x5230;Instance cancel register&#x7684;&#x8bf7;&#x6c42;&#x540e;&#xff0c;&#x7acb;&#x523b;&#x6267;&#x884c;&#x76f8;&#x5e94;&#x7684;&#x64cd;&#x4f5c;&#xff0c;&#x6bd4;&#x5982;&#x66f4;&#x65b0;&#x8fde;&#x63a5;&#x6570;&#x3001;&#x66f4;&#x65b0;&#x79df;&#x7ea6;&#x9608;&#x503c;&#x503c;&#x3002;</p></li>
  
<li>
  
<p>Eureka Server&#x8fd4;&#x56de;&#x7ed9;Eureka Client&#x7684;&#x503c;&#x4f1a;&#x5b58;&#x5728;&#x4e00;&#x4e2a;&#x7f13;&#x5b58;&#x91cc;&#xff0c;&#x9ed8;&#x8ba4;&#x6bcf;&#x9694;30s&#xff08;eureka.responseCacheUpdateIntervalMs&#xff09;&#x66f4;&#x65b0;&#x4e00;&#x4e0b;&#x7f13;&#x5b58;&#x503c;&#x3002; </p></li>
  
<li>
  
<p>Eureka Client&#x672c;&#x5730;&#x4e5f;&#x6709;&#x7f13;&#x5b58;&#xff0c;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;Client&#x6bcf;&#x9694;30s&#xff08;eureka.client.refresh.interval&#xff09;&#x8ddf;&#x670d;&#x52a1;&#x5668;&#x7aef;&#x540c;&#x6b65;&#x4e00;&#x4e0b;&#x4fe1;&#x606f;&#x3002;</p></li>
</ul>

<p>&#x603b;&#x7ed3;&#xff1a;&#x7531;&#x4e8e;EurekaServer&#x548c;EurekaClient&#x90fd;&#x6709;&#x7f13;&#x5b58;&#xff0c;&#x6240;&#x4ee5;Client&#x83b7;&#x5f97;&#x670d;&#x52a1;&#x53d8;&#x52a8;&#x6d88;&#x606f;&#x4f1a;&#x6709;&#x4e00;&#x4e2a;&#x5ef6;&#x8fdf;&#x3002; &#x5ef6;&#x8fdf;&#x65f6;&#x95f4;&#x4e3a;0 ~ (eureka.responseCacheUpdateIntervalMs + eureka.client.refresh.interval)</p>
</div>
<div class="section">
<h3><a name="a"></a><a href="#a">&#x9a8c;&#x8bc1;</a></h3>

<ul>
  
<li>&#x542f;&#x52a8;instance&#xff0c;&#x83b7;&#x5f97;&#x8fdb;&#x7a0b;pid&#xff0c;&#x4ee5;&#x4fbf;&#x4e0b;&#x4e00;&#x6b65;&#x4f7f;&#x7528;</li>
  
<li>&#x6a21;&#x62df;&#x5173;&#x95ed;instance&#xff0c;&#x5e76;&#x4e0d;&#x505c;&#x67e5;&#x8be2;instance&#xff0c;&#x83b7;&#x53d6;instance&#x4fe1;&#x606f;&#x53d8;&#x5316;&#xff0c;&#x5f97;&#x51fa;&#x53d8;&#x5316;&#x65f6;&#x95f4;</li>
</ul>

<p>&#x4ee5;&#x4e0b;&#x65f6;&#x5173;&#x952e;&#x6d4b;&#x8bd5;&#x4ee3;&#x7801;&#xff0c;&#x5728;mac&#x4e0a;&#x6d4b;&#x8bd5;&#x901a;&#x8fc7;&#xff0c;&#x53ef;&#x505a;&#x53c2;&#x8003;</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Runtime.getRuntime().exec(&quot;kill &quot;+pid); //pid &#x4e3a;instance &#x8fdb;&#x7a0b;id&#xff0c;&#x73af;&#x5883;&#x4e0d;&#x540c;id&#x4e0d;&#x540c;&#xff0c;&#x9700;&#x8981;&#x5728;&#x6267;&#x884c;&#x65f6;&#x4f20;&#x5165;

EurekaClient eurekaClient = new DiscoveryClient(applicationInfoManager, clientConfig);
Application application = eurekaClient.getApplication(&quot;MICROSERVICE-PROVIDER-USER&quot;);
if (application == null) {
    System.err.println(&quot;no application:&quot; + i);
    break;
} else {
    InstanceInfo instance = application.getByInstanceId(&quot;discovery:microservice-provider-user:8000&quot;);
    if (instance == null) {
        System.err.println(&quot;no intance:&quot; + i);
        break;
    } else {
        if (instance.getStatus() == InstanceStatus.DOWN) {
            System.err.println(&quot;intance-- down :&quot; + i);
            break;
        } else {
            System.err.println(&quot;intance :&quot; + i + &quot; &quot; + instance.getStatus());
        }
    }
}
</pre></div></div>
</div></div>
<div class="section">
<h2><a name="Spring_BootEurekaShutdown"></a><a href="#spring-booteurekashutdown">Spring Boot&#x73af;&#x5883;&#x4e0b;Eureka&#x7684;&#x66b4;&#x529b;Shutdown&#x672c;&#x5730;&#x670d;&#x52a1;</a></h2>

<p>&#x66b4;&#x529b;&#x5173;&#x95ed;&#x65f6;&#xff0c;&#x7531;&#x4e8e;&#x7f3a;&#x5c11;&#x901a;&#x77e5;&#x673a;&#x5236;&#xff0c;&#x53ea;&#x80fd;&#x901a;&#x8fc7;&#x79df;&#x7ea6;&#x8fc7;&#x671f;&#x6765;&#x5224;&#x65ad;&#x670d;&#x52a1;&#x662f;&#x5426;&#x6709;&#x6548;&#x3002; </p>

<ul>
  
<li>&#x4fdd;&#x62a4;&#x6a21;&#x5f0f;&#xff0c;&#x4e0d;&#x4f1a;&#x5220;&#x9664;&#x79df;&#x7ea6;&#x8fc7;&#x671f;&#x7684;&#x670d;&#x52a1;&#xff0c;&#x6b64;&#x65f6;&#x5ba2;&#x6237;&#x7aef;&#x4e0d;&#x4f1a;&#x5f97;&#x5230;&#x6b64;Instance&#x7684;&#x771f;&#x5b9e;&#x72b6;&#x6001;&#x4fe1;&#x606f;</li>
  
<li>&#x666e;&#x901a;&#x6a21;&#x5f0f;&#x4e0b;&#xff0c;&#x9ed8;&#x8ba4;&#x6bcf;&#x9694;1m&#xff08;eureka.evictionIntervalTimerInMs&#xff09;&#x68c0;&#x67e5;&#x4e00;&#x6b21;&#x79df;&#x7ea6;&#x662f;&#x5426;&#x8fc7;&#x671f;&#xff1b;</li>
</ul>

<p>&#x9ed8;&#x8ba4;&#x79df;&#x7ea6;&#x8fc7;&#x7684;&#x65f6;&#x95f4;&#x662f;90s&#xff08;eurka.lease.duration&#xff09;&#xff0c;&#x4f46;&#x7531;&#x4e8e;&#x4ee3;&#x7801;&#x4e0a;&#x7684;bug&#xff0c;&#x5b9e;&#x9645;&#x8fc7;&#x671f;&#x65f6;&#x95f4;&#x662f;&#x5176;2&#x500d;&#xff0c;&#x5bf9;&#x5e94;&#x6b64;&#x5904;&#x4e3a;180&#x3002;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x83b7;&#x5f97;&#x4fe1;&#x606f;&#x7684;&#x65f6;&#x95f4;&#x4e3a;&#xff1a;2 * eurka.lease.duration ~ 2 * eurka.lease.duration+ eureka.evictionIntervalTimerInMs + eureka.client.refresh.interval</p>

<p>bug&#x5bf9;&#x5e94;&#x7684;<a class="externalLink" href="https://github.com/Netflix/eureka/blob/v1.6.1/eureka-core/src/main/java/com/netflix/eureka/lease/Lease.java">&#x5b98;&#x65b9;&#x6ce8;&#x91ca;</a> line:103</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Note that due to renew() doing the 'wrong&quot; thing and setting lastUpdateTimestamp to +duration more than what it should be, 
the expiry will actually be 2 * duration.
This is a minor bug and should only affect instances that ungracefully shutdown. 
Due to possible wide ranging impact to existing usage, this will not be fixed.
</pre></div></div>

<ul>
  
<li>&#x9a8c;&#x8bc1;&#x3002;&#x5c06;&#x4e0a;&#x9762;&#x6837;&#x4f8b;&#x4ee3;&#x7801;&#x4e2d;&#x7684;kill&#x6539;&#x6210;kill -9&#x5373;&#x53ef;&#x3002;</li>
</ul>
</div>
<div class="section">
<h2><a name="a"></a><a href="#a">&#x8865;&#x5145;&#x8bf4;&#x660e;</a></h2>

<div class="section">
<h3><a name="Docker"></a><a href="#docker">Docker&#x73af;&#x5883;&#x4e0b;&#x7684;&#x6ce8;&#x610f;&#x4e8b;&#x9879;</a></h3>

<p>dockerfile&#x6587;&#x4ef6;&#x542f;&#x52a8;jar&#x65f6;&#x5982;&#x679c;&#x662f;&#x76f4;&#x63a5;&#x542f;&#x52a8;&#x7684;&#xff0c;&#x4e0d;&#x9700;&#x8981;&#x505a;&#x7279;&#x6b8a;&#x5904;&#x7406;&#xff1b;&#x5982;&#x679c;&#x662f;&#x901a;&#x8fc7;shell&#x811a;&#x672c;&#x95f4;&#x63a5;&#x542f;&#x52a8;&#x7684;&#xff0c;SIGTERM&#x4e0d;&#x4f1a;&#x4ece;shell&#x4f20;&#x9012;&#x5230;java&#x8fdb;&#x7a0b;&#xff0c;&#x9700;&#x8981;&#x53c2;&#x7167;<a class="externalLink" href="http://veithen.github.io/2014/11/16/sigterm-propagation.html">&#x8fd9;&#x4e2a;&#x6587;&#x6863;</a>&#x8fdb;&#x884c;&#x4fee;&#x6539;&#x3002;</p>

<p>&#x76ee;&#x524d;&#x6211;&#x4eec;&#x91c7;&#x7528;&#x7684;&#x4fee;&#x6539;&#x662f;&#x5728;java&#x6307;&#x4ee4;&#x524d;exec&#xff0c;&#x5982;&#x4e0b;&#x6240;&#x793a;</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">exec java ${JAVA_OPTS} -jar *.jar;
</pre></div></div>
</div>
<div class="section">
<h3><a name="aEureka_Instance"></a><a href="#aeureka-instance-">&#x5f53;&#x670d;&#x52a1;&#x786c;&#x5173;&#x95ed;&#x65f6;Eureka Instance&#x7684;&#x53d8;&#x5316;&#x662f;&#x5426;&#x53ef;&#x4ee5;&#x7acb;&#x5373;&#x901a;&#x77e5;&#x5230;&#x4f9d;&#x8d56;&#x5b83;&#x7684;&#x5176;&#x5b83;&#x670d;&#x52a1;?</a></h3>

<p>&#x6839;&#x636e;&#x6211;&#x4eec;&#x4e0e;spring-cloud-netflix&#x5f00;&#x53d1;&#x4eba;&#x5458;&#x7684;&#x6c9f;&#x901a;&#x4ee5;&#x53ca;netflix&#x4e0a;issues&#x4e0a;&#x8ba8;&#x8bba;&#x53ef;&#x4ee5;&#x770b;&#x51fa;&#x5b98;&#x65b9;&#x7684;&#x6001;&#x5ea6;&#x662f;&#x6682;&#x4e0d;&#x8003;&#x8651;&#x5bf9;&#x7acb;&#x523b;&#x901a;&#x77e5;&#x7684;&#x652f;&#x6301;&#x3002; issues&#x5730;&#x5740;&#x5982;&#x4e0b;: <a class="externalLink" href="https://github.com/spring-cloud/spring-cloud-netflix/issues/1453">https://github.com/spring-cloud/spring-cloud-netflix/issues/1453</a> <a class="externalLink" href="https://github.com/Netflix/eureka/issues/820">https://github.com/Netflix/eureka/issues/820</a></p>

<p>netflix&#x548c;spring-cloud&#x5b98;&#x65b9;&#x4e0d;&#x652f;&#x6301;&#x7acb;&#x523b;&#x901a;&#x77e5;&#x7684;&#x539f;&#x56e0;&#x662f;: nextflix&#x8bbe;&#x8ba1;&#x7684;&#x8fd9;&#x5957;&#x5fae;&#x670d;&#x52a1;&#x65b9;&#x6848;&#x5927;&#x91cf;&#x4f7f;&#x7528;&#x5ba2;&#x6237;&#x7aef;&#x6545;&#x969c;&#x68c0;&#x6d4b;&#x9694;&#x79bb;&#x548c;&#x5ba2;&#x6237;&#x7aef;&#x8d1f;&#x8f7d;&#x5747;&#x8861;&#xff0c;&#x4f7f;&#x5f97;&#x6574;&#x4f53;&#x67b6;&#x6784;&#x5177;&#x5907;&#x66f4;&#x597d;&#x7684;&#x5f39;&#x6027;&#x548c;&#x5bb9;&#x9519;&#x6027;&#x3002; &#x5f3a;&#x8c03;&#x9ad8;&#x53ef;&#x7528;&#x6027;&#xff0c;&#x5141;&#x8bb8;Eureka&#x4e0a;&#x5b58;&#x5728;&#x810f;&#x6570;&#x636e;&#xff0c;&#x5bf9;&#x4e8e;&#x65e0;&#x6cd5;&#x8bbf;&#x95ee;&#x7684;&#x8282;&#x70b9;&#x5ba2;&#x6237;&#x7aef;&#x4f1a;&#x81ea;&#x52a8;&#x5254;&#x9664;&#x6216;&#x964d;&#x6743;&#xff0c;&#x7a0d;&#x540e;&#x91cd;&#x8bd5;&#x7b49;&#x7b49;&#xff0c;&#x8fd9;&#x4e9b;&#x673a;&#x5236;&#x8db3;&#x4ee5;&#x4fdd;&#x8bc1;&#x6b63;&#x5e38;&#x5de5;&#x4f5c;&#x3002; &#x670d;&#x52a1;&#x662f;&#x5426;&#x53ef;&#x7528;&#x6216;&#x6027;&#x80fd;&#x5982;&#x4f55;&#x4ee5;&#x670d;&#x52a1;&#x6d88;&#x8d39;&#x8005;(&#x5ba2;&#x6237;&#x7aef;)&#x89c6;&#x89d2;&#x4e3a;&#x51c6;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x4ee5;Eureka&#x6216;Zookeeper&#x4e3a;&#x51c6;&#x3002;</p>
</div></div>
<div class="section">
<h2><a name="aspring-boot"></a>&#x5982;&#x4f55;&#x4f18;&#x96c5;&#x5173;&#x95ed;&#x7ebf;&#x4e0a;spring-boot&#x670d;&#x52a1;</h2>

<ul>
  
<li>
    
<p>&#x5f15;&#x5165;&#x4e0b;&#x5217;&#x4f9d;&#x8d56;&#x4ee5;&#x83b7;&#x5f97;<tt>/pause</tt>&#x548c;<tt>/shutdown</tt> management endpoints(provided by actuator)</p>
    
<p>  org.springframework.cloud  spring-cloud-starter    org.springframework.boot  spring-boot-starter-actuator </p>
  </li>
  
<li>
  
<p>A POST to <tt>/pause</tt> will result in a status of DOWN in eureka (thanks to cloud-starter)</p></li>
  
<li>When the eureka clients receive the status, Ribbon won&#x2019;t route any request to your DOWN service.</li>
  
<li>Wait for the application cool down (no more RPC call).</li>
  
<li>Posting to /shutdown will gracefully stop the application.</li>
</ul>

<p>&#x53c2;&#x8003;&#x6587;&#x6863;<br /><a class="externalLink" href="http://stackoverflow.com/questions/33231664/spring-eureka-gently-shutdown-a-service">spring-eureka-gently-shutdown-a-service</a> <a class="externalLink" href="http://stackoverflow.com/questions/32969360/spring-feign-failover">http://stackoverflow.com/questions/32969360/spring-feign-failover</a></p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2017.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
