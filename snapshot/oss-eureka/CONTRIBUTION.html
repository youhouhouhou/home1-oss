<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2017-04-19 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>oss-eureka &#x2013; 构建eureka docker镜像</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                oss-eureka
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-04-19</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0.6.OSS-SNAPSHOT</span>
                      </div>
            <div class="xright">      
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
                                <h5>Parent Project</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="oss-build">oss-build</a>
            </li>
          </ul>
                       <h5>DOCUMENTATION</h5>
                  <ul>
                  <li class="none">
                          <a href="README.html" title="README">README</a>
            </li>
                  <li class="none">
            <strong>开发</strong>
          </li>
                  <li class="none">
                          <a href="GRACEFUL_SHUTDOWN.html" title="优雅关闭服务">优雅关闭服务</a>
            </li>
                  <li class="none">
                          <a href="SELF_PRESERVATION.html" title="自我保护模式">自我保护模式</a>
            </li>
                  <li class="none">
                          <a href="PERFORMANCE.html" title="压力测试">压力测试</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                 
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2><a name="aeureka_docker"></a><a href="#aeureka-docker">&#x6784;&#x5efa;eureka docker&#x955c;&#x50cf;</a></h2>

<div class="source">
<div class="source">
<pre># &#x672c;&#x5730;docker&#x6784;&#x5efa;
DOCKER_HOST=unix:///var/run/docker.sock mvn clean package docker:build docker:push

# &#x8fdc;&#x7a0b;docker&#x6784;&#x5efa;
DOCKER_HOST=tcp://&lt;host&gt;:2375 mvn clean package docker:build docker:push
</pre></div></div>
</div>
<div class="section">
<h2><a name="Debug_Docker_cluster"></a><a href="#debug-docker-cluster">Debug Docker cluster</a></h2>

<div class="source">
<div class="source">
<pre>HOST_IP_ADDRESS=&quot;${&#x7ed9;EUREKA&#x5ba2;&#x6237;&#x7aef;&#x8bbf;&#x95ee;&#x7684;IP&#x5730;&#x5740;}&quot;

if [[ -z &quot;${HOST_IP_ADDRESS}&quot; ]]; then HOST_IP_ADDRESS=&quot;127.0.0.1&quot;; fi
EUREKA_PEER1_IP_ADDRESS=&quot;${HOST_IP_ADDRESS}&quot;
EUREKA_PEER1_PORT=&quot;8761&quot;
EUREKA_PEER2_IP_ADDRESS=&quot;${HOST_IP_ADDRESS}&quot;
EUREKA_PEER2_PORT=&quot;8762&quot;
EUREKA_PEER3_IP_ADDRESS=&quot;${HOST_IP_ADDRESS}&quot;
EUREKA_PEER3_PORT=&quot;8763&quot;

PEER=&quot;peer1&quot;
EUREKA_INSTANCE_NONSECUREPORT=&quot;${EUREKA_PEER1_PORT}&quot;

PEER=&quot;peer2&quot;
EUREKA_INSTANCE_NONSECUREPORT=&quot;${EUREKA_PEER2_PORT}&quot;

PEER=&quot;peer3&quot;
EUREKA_INSTANCE_NONSECUREPORT=&quot;${EUREKA_PEER3_PORT}&quot;

docker run --rm -it \
-v $(pwd):/root/app \
-p ${EUREKA_INSTANCE_NONSECUREPORT}:8761 \
--name eureka-${PEER} \
--hostname eureka-${PEER}.infra.yixinonline.org \
-e SPRING_PROFILES_ACTIVE=cloud,${PEER} \
-e EUREKA_INSTANCE_HOSTNAME=eureka-${PEER}.infra.yixinonline.org \
-e EUREKA_INSTANCE_PREFER_IP_ADDRESS=false \
-e EUREKA_INSTANCE_IP_ADDRESS=${HOST_IP_ADDRESS} \
-e CLOUD_CLIENT_HOSTNAME=eureka-${PEER}.infra.yixinonline.org \
-e CLOUD_CLIENT_IP_ADDRESS=${HOST_IP_ADDRESS} \
-e SERVER_PORT=8761 \
-e EUREKA_INSTANCE_NONSECUREPORT=${EUREKA_INSTANCE_NONSECUREPORT} \
-e EUREKA_PEER1_HOST=eureka-peer1.infra.yixinonline.org \
-e EUREKA_PEER1_PORT=${EUREKA_PEER1_PORT} \
-e EUREKA_PEER2_HOST=eureka-peer2.infra.yixinonline.org \
-e EUREKA_PEER2_PORT=${EUREKA_PEER2_PORT} \
-e EUREKA_PEER3_HOST=eureka-peer3.infra.yixinonline.org \
-e EUREKA_PEER3_PORT=${EUREKA_PEER3_PORT} \
--add-host eureka-peer1.infra.yixinonline.org:${EUREKA_PEER1_IP_ADDRESS} \
--add-host eureka-peer2.infra.yixinonline.org:${EUREKA_PEER2_IP_ADDRESS} \
--add-host eureka-peer3.infra.yixinonline.org:${EUREKA_PEER3_IP_ADDRESS} \
registry.docker.local/java:oracle-8u101-jdk-alpine \
&quot;${PEER}&quot;
</pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2017.
          All rights reserved.    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
